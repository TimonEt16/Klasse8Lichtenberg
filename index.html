<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offertly - KI-Angebotsgenerator für Selbstständige</title>
    <meta name="description" content="Professionelle Angebote in Minuten erstellen mit künstlicher Intelligenz für Handwerker, Freelancer und Selbstständige">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://offertly.example.com/">
    <meta property="og:title" content="Offertly - KI-Angebotsgenerator">
    <meta property="og:description" content="Professionelle Angebote in Minuten erstellen mit KI">
    <meta property="og:image" content="https://offertly.example.com/images/social-preview.jpg">
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://offertly.example.com/">
    <meta property="twitter:title" content="Offertly - KI-Angebotsgenerator">
    <meta property="twitter:description" content="Professionelle Angebote in Minuten erstellen mit KI">
    <meta property="twitter:image" content="https://offertly.example.com/images/social-preview.jpg">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #2a4bc9;
            --secondary: #3a0ca3;
            --accent: #4cc9f0;
            --light: #ffffff;
            --dark: #121826;
            --gray: #6c757d;
            --light-gray: #f5f7fa;
            --border-radius: 12px;
            --shadow: 0 10px 30px rgba(0,0,0,0.05);
            --transition: all 0.3s ease;
            --card-shadow: 0 8px 24px rgba(0,0,0,0.04);
            --header-height: 80px;
            --error: #e53e3e;
            --success: #38a169;
            --warning: #dd6b20;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background-color: var(--light-gray);
            color: var(--dark);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            line-height: 1.6;
        }

        /* Header Styling */
        header {
            height: var(--header-height);
            background: var(--light);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            padding: 0 5%;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            font-size: 28px;
            color: var(--primary);
        }

        .logo-text {
            font-size: 22px;
            font-weight: 700;
            color: var(--dark);
            letter-spacing: -0.5px;
        }

        .ai-badge {
            background: linear-gradient(135deg, var(--accent) 0%, #06b6d4 100%);
            color: var(--dark);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        nav {
            margin-left: auto;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .nav-link {
            color: #4a5568;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }

        .nav-link:hover {
            color: var(--primary);
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.25);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(67, 97, 238, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .btn-secondary:hover {
            background: rgba(67, 97, 238, 0.05);
        }

        /* Main Content */
        .main-container {
            flex: 1;
            padding: 30px 5%;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
        }

        .hero-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 60px;
        }

        @media (max-width: 1024px) {
            .hero-section {
                grid-template-columns: 1fr;
            }
        }

        .hero-text {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .hero-title {
            font-size: 36px;
            font-weight: 800;
            line-height: 1.2;
            color: var(--dark);
            margin-bottom: 20px;
        }

        .hero-title span {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .hero-subtitle {
            font-size: 18px;
            color: #4a5568;
            margin-bottom: 30px;
            font-weight: 400;
        }

        .app-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 60px;
        }

        @media (max-width: 1024px) {
            .app-container {
                grid-template-columns: 1fr;
            }
        }

        .app-card {
            background: var(--light);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .card-header {
            padding: 25px 30px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: rgba(67, 97, 238, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 18px;
        }

        .card-body {
            padding: 30px;
            flex: 1;
            overflow-y: auto;
        }

        /* Form Styling */
        .form-section {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        label {
            font-weight: 600;
            font-size: 14px;
            color: var(--dark);
        }

        .required::after {
            content: " *";
            color: var(--error);
        }

        input, textarea, select {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 15px;
            transition: var(--transition);
            background: var(--light);
            color: var(--dark);
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 120px;
        }

        .input-hint {
            font-size: 13px;
            color: var(--gray);
            font-style: italic;
            margin-top: 5px;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }

        /* Error Styling */
        .error-message {
            color: var(--error);
            font-size: 13px;
            margin-top: 5px;
            display: none;
        }

        .has-error input,
        .has-error textarea,
        .has-error select {
            border-color: var(--error);
            box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.1);
        }

        .has-error .error-message {
            display: block;
        }

        /* Custom Branch Input */
        .custom-branch {
            display: none;
            margin-top: 10px;
        }

        .custom-branch.show {
            display: block;
        }

        /* Preview Styling */
        .preview-container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            min-height: 100%;
            font-family: 'Georgia', serif;
            line-height: 1.6;
            box-shadow: 0 0 10px rgba(0,0,0,0.03);
            position: relative;
            border: 1px solid #edf2f7;
        }

        .offer-header {
            border-bottom: 2px solid var(--primary);
            padding-bottom: 25px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .company-info {
            flex: 1;
        }

        .company-name {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .company-address {
            color: var(--gray);
            font-size: 14px;
            line-height: 1.5;
        }

        .offer-meta {
            text-align: right;
        }

        .offer-number {
            font-size: 16px;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .offer-date {
            color: var(--gray);
            font-size: 14px;
        }

        .customer-info {
            background: var(--light-gray);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            font-size: 15px;
        }

        .customer-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .offer-content {
            margin-bottom: 30px;
        }

        .offer-greeting {
            margin-bottom: 25px;
        }

        .service-description {
            background: #f0f4ff;
            padding: 25px;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
            margin: 25px 0;
            font-size: 15px;
        }

        .price-section {
            background: #f8faff;
            padding: 25px;
            border-radius: 8px;
            margin-top: 25px;
            border: 1px solid #e2e8f0;
        }

        .price-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 16px;
            padding: 5px 0;
        }

        .price-total {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary);
            border-top: 2px solid var(--primary);
            padding-top: 12px;
            margin-top: 12px;
        }

        .terms-section {
            margin-top: 35px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
            font-size: 13px;
            color: var(--gray);
        }

        .empty-preview {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            height: 100%;
            padding: 30px;
            color: var(--gray);
        }

        .empty-icon {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 25px;
            opacity: 0.6;
        }

        .empty-title {
            font-size: 22px;
            margin-bottom: 15px;
            color: var(--dark);
            font-weight: 600;
        }

        .empty-text {
            max-width: 400px;
            margin-bottom: 25px;
        }

        .loading {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 20px;
            z-index: 10;
            border-radius: 8px;
            display: none;
        }

        .loading.show {
            display: flex;
        }

        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid #e2e8f0;
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            background: var(--accent);
            color: var(--dark);
            border-radius: 8px;
            font-weight: 600;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateY(100px);
            opacity: 0;
            transition: var(--transition);
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.error {
            background: var(--error);
            color: white;
        }

        .toast.success {
            background: var(--success);
            color: white;
        }

        /* Mobile Menu */
        .mobile-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 90;
            display: none;
        }

        .mobile-menu-overlay.show {
            display: block;
        }

        .mobile-nav {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100vh;
            background: white;
            z-index: 100;
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            transition: var(--transition);
            box-shadow: -5px 0 15px rgba(0,0,0,0.1);
        }

        .mobile-nav.show {
            right: 0;
        }

        .mobile-nav-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .mobile-nav-link {
            padding: 12px 0;
            border-bottom: 1px solid #e2e8f0;
            color: var(--dark);
            text-decoration: none;
            font-weight: 500;
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: #a0aec0;
            padding: 40px 5% 30px;
        }

        .footer-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 40px;
            max-width: 1400px;
            margin: 0 auto;
        }

        @media (max-width: 768px) {
            .footer-container {
                grid-template-columns: 1fr;
            }
        }

        .footer-logo {
            font-size: 24px;
            font-weight: 700;
            color: white;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-text {
            margin-bottom: 25px;
            line-height: 1.7;
        }

        .footer-heading {
            font-size: 18px;
            font-weight: 600;
            color: white;
            margin-bottom: 25px;
        }

        .footer-links {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .footer-link {
            color: #a0aec0;
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-link:hover {
            color: white;
        }

        .copyright {
            text-align: center;
            padding-top: 40px;
            margin-top: 40px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #718096;
            font-size: 14px;
        }

        /* Legal Pages */
        .legal-page {
            max-width: 800px;
            margin: 40px auto;
            padding: 30px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
        }

        .legal-page h1 {
            color: var(--primary);
            margin-bottom: 30px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
        }

        .legal-page h2 {
            color: var(--primary);
            margin: 25px 0 15px;
        }

        .legal-page p {
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .legal-page ul {
            margin-bottom: 15px;
            padding-left: 20px;
        }

        /* Dark Mode */
        body.dark-mode {
            background-color: #1a202c;
            color: #e2e8f0;
        }

        body.dark-mode .app-card,
        body.dark-mode .preview-container,
        body.dark-mode .legal-page {
            background-color: #2d3748;
            color: #e2e8f0;
        }

        body.dark-mode input,
        body.dark-mode textarea,
        body.dark-mode select {
            background-color: #4a5568;
            color: #f7fafc;
            border-color: #4a5568;
        }

        body.dark-mode .customer-info,
        body.dark-mode .service-description,
        body.dark-mode .price-section {
            background-color: rgba(74, 85, 104, 0.5);
        }

        body.dark-mode header {
            background-color: #2d3748;
        }

        body.dark-mode .logo-text {
            color: #f7fafc;
        }

        body.dark-mode .nav-link {
            color: #cbd5e0;
        }

        body.dark-mode .nav-link:hover {
            color: var(--accent);
        }

        /* Theme Toggle */
        .theme-toggle {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 20px;
            margin-left: 15px;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            header {
                padding: 0 20px;
                height: 70px;
            }
            
            .logo-text {
                font-size: 18px;
            }
            
            .hero-title {
                font-size: 28px;
            }
            
            .hero-subtitle {
                font-size: 16px;
            }
            
            .main-container {
                padding: 20px;
            }
            
            .card-body {
                padding: 20px;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            nav {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
        }
        
        @media (max-width: 480px) {
            .card-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .hero-title {
                font-size: 24px;
            }
            
            .hero-subtitle {
                font-size: 16px;
            }
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--primary);
            font-size: 24px;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
                margin-left: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="logo-container">
            <i class="fas fa-file-invoice-dollar logo-icon"></i>
            <div class="logo-text">Offertly</div>
            <span class="ai-badge">KI-Powered</span>
        </div>
        
        <nav id="desktopNav">
            <a href="#" class="nav-link">Start</a>
            <a href="#features" class="nav-link">Funktionen</a>
            <a href="#pricing" class="nav-link">Preise</a>
            <a href="#impressum" class="nav-link">Impressum</a>
            <button class="theme-toggle" id="themeToggle" title="Dark Mode umschalten">
                <i class="fas fa-moon"></i>
            </button>
        </nav>
        
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>
    </header>

    <!-- Mobile Navigation -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
    <div class="mobile-nav" id="mobileNav">
        <div class="mobile-nav-header">
            <div class="logo-container">
                <i class="fas fa-file-invoice-dollar logo-icon"></i>
                <div class="logo-text">Offertly</div>
            </div>
            <button class="mobile-menu-btn" id="mobileCloseBtn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <a href="#" class="mobile-nav-link">Start</a>
        <a href="#features" class="mobile-nav-link">Funktionen</a>
        <a href="#pricing" class="mobile-nav-link">Preise</a>
        <a href="#impressum" class="mobile-nav-link">Impressum</a>
        <a href="datenschutz.html" class="mobile-nav-link">Datenschutz</a>
        <a href="agb.html" class="mobile-nav-link">AGB</a>
        <button class="btn btn-secondary" id="mobileThemeToggle">
            <i class="fas fa-moon"></i> Dark Mode
        </button>
    </div>

    <!-- Hero Section -->
    <div class="main-container">
        <section class="hero-section">
            <div class="hero-text">
                <h1 class="hero-title">Professionelle Angebote <span>in Minuten</span> erstellen</h1>
                <p class="hero-subtitle">KI-generierte Angebote für Handwerker, Freelancer und Selbstständige. Sparen Sie Zeit und überzeugen Sie Ihre Kunden.</p>
                
                <div class="form-actions">
                    <button class="btn btn-primary" style="padding: 14px 28px; font-size: 16px;" id="heroGenerateBtn">
                        <i class="fas fa-bolt"></i> Jetzt Angebot erstellen
                    </button>
                    <button class="btn btn-secondary" style="padding: 14px 28px; font-size: 16px;" id="learnMoreBtn">
                        <i class="fas fa-info-circle"></i> Mehr erfahren
                    </button>
                </div>
            </div>
            
            <div class="hero-image">
                <div style="width: 100%; height: 400px; background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%); border-radius: var(--border-radius); display: flex; align-items: center; justify-content: center; box-shadow: 0 20px 40px rgba(67, 97, 238, 0.2);">
                    <div style="text-align: center; color: white; padding: 20px;">
                        <i class="fas fa-file-invoice" style="font-size: 80px; margin-bottom: 20px;"></i>
                        <h2 style="font-size: 28px; margin-bottom: 15px;">KI-Angebotsgenerator</h2>
                        <p style="font-size: 18px;">Schnell, einfach und professionell</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features-section" id="features" style="margin-bottom: 60px;">
            <h2 style="text-align: center; font-size: 32px; margin-bottom: 40px; color: var(--dark);">Unsere Funktionen</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px;">
                <div style="background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--card-shadow);">
                    <div style="width: 60px; height: 60px; background: rgba(67, 97, 238, 0.1); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; color: var(--primary); font-size: 24px;">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h3 style="font-size: 20px; margin-bottom: 15px; color: var(--dark);">KI-optimierte Texte</h3>
                    <p style="color: var(--gray);">Unsere KI formuliert professionelle Angebotstexte basierend auf Ihren Eingaben, angepasst an Ihre Branche.</p>
                </div>
                
                <div style="background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--card-shadow);">
                    <div style="width: 60px; height: 60px; background: rgba(67, 97, 238, 0.1); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; color: var(--primary); font-size: 24px;">
                        <i class="fas fa-file-pdf"></i>
                    </div>
                    <h3 style="font-size: 20px; margin-bottom: 15px; color: var(--dark);">PDF-Export</h3>
                    <p style="color: var(--gray);">Exportieren Sie Ihr Angebot als hochwertiges PDF mit einem Klick, bereit zum Versand an Ihre Kunden.</p>
                </div>
                
                <div style="background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--card-shadow);">
                    <div style="width: 60px; height: 60px; background: rgba(67, 97, 238, 0.1); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; color: var(--primary); font-size: 24px;">
                        <i class="fas fa-save"></i>
                    </div>
                    <h3 style="font-size: 20px; margin-bottom: 15px; color: var(--dark);">Automatisches Speichern</h3>
                    <p style="color: var(--gray);">Ihre Entwürfe werden automatisch gespeichert, sodass Sie später weiterarbeiten können.</p>
                </div>
            </div>
        </section>

        <!-- Pricing Section -->
        <section class="pricing-section" id="pricing" style="margin-bottom: 60px;">
            <h2 style="text-align: center; font-size: 32px; margin-bottom: 40px; color: var(--dark);">Preise</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; max-width: 1000px; margin: 0 auto;">
                <div style="background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--card-shadow); text-align: center; border: 2px solid var(--primary);">
                    <h3 style="font-size: 24px; margin-bottom: 15px; color: var(--primary);">Basis</h3>
                    <div style="font-size: 40px; font-weight: 700; margin-bottom: 20px; color: var(--dark);">€0<span style="font-size: 16px; color: var(--gray);">/Monat</span></div>
                    <ul style="text-align: left; margin-bottom: 30px; list-style: none;">
                        <li style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> 5 Angebote/Monat</li>
                        <li style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> PDF-Export</li>
                        <li style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> Basis-Vorlagen</li>
                        <li style="padding: 8px 0;"><i class="fas fa-times" style="color: var(--gray); margin-right: 10px;"></i> <span style="color: var(--gray);">Keine KI-Optimierung</span></li>
                    </ul>
                    <button class="btn btn-secondary" style="width: 100%;">Kostenlos starten</button>
                </div>
                
                <div style="background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--card-shadow); text-align: center; border: 2px solid var(--accent); position: relative;">
                    <div style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: var(--accent); color: var(--dark); padding: 5px 15px; border-radius: 20px; font-weight: 600; font-size: 14px;">Empfohlen</div>
                    <h3 style="font-size: 24px; margin-bottom: 15px; color: var(--primary);">Profi</h3>
                    <div style="font-size: 40px; font-weight: 700; margin-bottom: 20px; color: var(--dark);">€9<span style="font-size: 16px; color: var(--gray);">/Monat</span></div>
                    <ul style="text-align: left; margin-bottom: 30px; list-style: none;">
                        <li style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> Unbegrenzte Angebote</li>
                        <li style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> PDF-Export</li>
                        <li style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> Premium-Vorlagen</li>
                        <li style="padding: 8px 0;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> KI-Optimierung</li>
                    </ul>
                    <button class="btn btn-primary" style="width: 100%;">Jetzt upgraden</button>
                </div>
                
                <div style="background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--card-shadow); text-align: center; border: 2px solid var(--primary);">
                    <h3 style="font-size: 24px; margin-bottom: 15px; color: var(--primary);">Unternehmen</h3>
                    <div style="font-size: 40px; font-weight: 700; margin-bottom: 20px; color: var(--dark);">€29<span style="font-size: 16px; color: var(--gray);">/Monat</span></div>
                    <ul style="text-align: left; margin-bottom: 30px; list-style: none;">
                        <li style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> Unbegrenzte Angebote</li>
                        <li style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> PDF-Export</li>
                        <li style="padding: 8px 0; border-bottom: 1px solid #e2e8f0;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> Premium-Vorlagen</li>
                        <li style="padding: 8px 0;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> Erweiterte KI-Optimierung</li>
                    </ul>
                    <button class="btn btn-secondary" style="width: 100%;">Für Teams</button>
                </div>
            </div>
        </section>

        <!-- App Container -->
        <section class="app-container">
            <!-- Form Panel -->
            <div class="app-card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon">
                            <i class="fas fa-edit"></i>
                        </div>
                        Angebot erstellen
                    </div>
                    <div>
                        <button class="btn btn-secondary" id="resetBtn">
                            <i class="fas fa-redo"></i> Zurücksetzen
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <form id="offerForm" class="form-section">
                        <div class="form-group">
                            <label for="businessName" class="required">Ihr Firmenname</label>
                            <input type="text" id="businessName" name="businessName" required 
                                   placeholder="z.B. Malerbetrieb Schmidt GmbH">
                            <div class="error-message" id="businessNameError">Bitte geben Sie einen Firmennamen ein</div>
                        </div>

                        <div class="form-group">
                            <label for="businessAddress">Ihre Firmenadresse</label>
                            <textarea id="businessAddress" name="businessAddress" 
                                      placeholder="Firmenstraße 123&#10;12345 Stadt&#10;Tel: 0123/456789"></textarea>
                            <div class="input-hint">Wird im Angebot als Absender angezeigt</div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="businessType">Branche</label>
                                <select id="businessType" name="businessType">
                                    <option value="handwerk">Handwerk</option>
                                    <option value="maler">Maler/Lackierer</option>
                                    <option value="elektriker">Elektriker</option>
                                    <option value="it">IT/Webdesign</option>
                                    <option value="beratung">Beratung/Coaching</option>
                                    <option value="fotografie">Fotografie</option>
                                    <option value="reinigung">Reinigung</option>
                                    <option value="garten">Garten/Landschaft</option>
                                    <option value="sonstiges">Sonstiges</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="offerDate">Angebotsdatum</label>
                                <input type="date" id="offerDate" name="offerDate">
                            </div>
                        </div>
                        
                        <!-- Custom Branch Input -->
                        <div class="form-group custom-branch" id="customBranchContainer">
                            <label for="customBranch" class="required">Bitte Branche angeben</label>
                            <input type="text" id="customBranch" name="customBranch" 
                                   placeholder="z.B. Eventmanagement, Tierpflege...">
                            <div class="error-message" id="customBranchError">Bitte geben Sie Ihre Branche an</div>
                        </div>

                        <div class="form-group">
                            <label for="customerName" class="required">Kundenname</label>
                            <input type="text" id="customerName" name="customerName" required 
                                   placeholder="Max Mustermann">
                            <div class="error-message" id="customerNameError">Bitte geben Sie einen Kundennamen ein</div>
                        </div>

                        <div class="form-group">
                            <label for="customerAddress">Kundenadresse</label>
                            <textarea id="customerAddress" name="customerAddress" 
                                      placeholder="Musterstraße 123&#10;12345 Musterstadt"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="serviceDescription" class="required">Leistungsbeschreibung</label>
                            <textarea id="serviceDescription" name="serviceDescription" required
                                      placeholder="z.B. Streichen von 40m² Wandfläche, 2 Anstriche, inkl. Material"></textarea>
                            <div class="error-message" id="serviceDescriptionError">Bitte beschreiben Sie die Leistung</div>
                            <div class="input-hint">Beschreiben Sie kurz, was Sie anbieten. Die KI erstellt daraus professionelle Formulierungen.</div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="totalPrice" class="required">Gesamtpreis (€)</label>
                                <input type="number" id="totalPrice" name="totalPrice" required 
                                       step="0.01" placeholder="480.00" min="0">
                                <div class="error-message" id="totalPriceError">Bitte geben Sie einen gültigen Preis ein</div>
                            </div>
                            <div class="form-group">
                                <label for="vatRate">MwSt. (%)</label>
                                <input type="number" id="vatRate" name="vatRate" step="0.1" 
                                       placeholder="19" value="19" min="0" max="100">
                                <div class="error-message" id="vatRateError">Bitte geben Sie einen gültigen MwSt.-Satz ein (0-100%)</div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="deliveryTime">Ausführungszeitraum</label>
                            <input type="text" id="deliveryTime" name="deliveryTime" 
                                   placeholder="z.B. KW 32/2025 oder nach Vereinbarung">
                        </div>

                        <div class="form-group">
                            <label for="paymentTerms">Zahlungsbedingungen</label>
                            <select id="paymentTerms" name="paymentTerms">
                                <option value="sofort">Zahlung bei Auftragserteilung</option>
                                <option value="abnahme">Zahlung bei Abnahme</option>
                                <option value="14tage">Zahlung innerhalb 14 Tagen</option>
                                <option value="30tage">Zahlung innerhalb 30 Tagen</option>
                                <option value="anzahlung">50% Anzahlung, Rest bei Fertigstellung</option>
                            </select>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary" id="generateBtn" style="flex: 1; padding: 16px;">
                                <i class="fas fa-robot"></i> Angebot erstellen
                            </button>
                            <button type="button" class="btn btn-secondary" id="saveDraftBtn" style="flex: 1; padding: 16px;">
                                <i class="fas fa-save"></i> Entwurf speichern
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Preview Panel -->
            <div class="app-card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon">
                            <i class="fas fa-eye"></i>
                        </div>
                        Angebotsvorschau
                    </div>
                    <div>
                        <button class="btn btn-secondary" id="downloadBtn">
                            <i class="fas fa-download"></i> PDF
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="preview-container" id="previewContainer">
                        <div class="loading" id="loading">
                            <div class="loader"></div>
                            <div class="loading-text">KI generiert Ihr Angebot...</div>
                        </div>
                        <div id="previewContent">
                            <div class="empty-preview">
                                <i class="fas fa-file-alt empty-icon"></i>
                                <h3 class="empty-title">Ihr Angebot erscheint hier</h3>
                                <p class="empty-text">Füllen Sie das Formular aus und klicken Sie auf "Angebot erstellen", um eine professionelle Angebotsvorlage zu generieren.</p>
                                <button class="btn btn-secondary" id="demoBtn">
                                    <i class="fas fa-magic"></i> Demo anzeigen
                                </button>
                                <button class="btn btn-secondary" id="loadDraftBtn" style="margin-top: 15px;">
                                    <i class="fas fa-folder-open"></i> Entwurf laden
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Impressum Section -->
        <section class="legal-page" id="impressum">
            <h1>Impressum</h1>
            
            <h2>Angaben gemäß § 5 TMG:</h2>
            <p>Offertly GmbH<br>
            Musterstraße 123<br>
            12345 Musterstadt</p>
            
            <h2>Vertreten durch:</h2>
            <p>Geschäftsführer: Max Mustermann</p>
            
            <h2>Kontakt:</h2>
            <p>Telefon: +49 (0) 123 456789<br>
            E-Mail: info@offertly.example.com</p>
            
            <h2>Registereintrag:</h2>
            <p>Eintragung im Handelsregister.<br>
            Registergericht: Amtsgericht Musterstadt<br>
            Registernummer: HRB 12345</p>
            
            <h2>Umsatzsteuer-ID:</h2>
            <p>Umsatzsteuer-Identifikationsnummer gemäß §27a Umsatzsteuergesetz:<br>
            DE123456789</p>
            
            <h2>Verantwortlich für den Inhalt nach § 55 Abs. 2 RStV:</h2>
            <p>Max Mustermann<br>
            Musterstraße 123<br>
            12345 Musterstadt</p>
            
            <h2>Haftungsausschluss:</h2>
            <h3>Haftung für Inhalte</h3>
            <p>Die Inhalte unserer Seiten wurden mit größter Sorgfalt erstellt. Für die Richtigkeit, Vollständigkeit und Aktualität der Inhalte können wir jedoch keine Gewähr übernehmen. Als Diensteanbieter sind wir gemäß § 7 Abs.1 TMG für eigene Inhalte auf diesen Seiten nach den allgemeinen Gesetzen verantwortlich.</p>
            
            <h3>Haftung für Links</h3>
            <p>Unser Angebot enthält Links zu externen Webseiten Dritter, auf deren Inhalte wir keinen Einfluss haben. Für die Inhalte der verlinkten Seiten ist stets der jeweilige Anbieter oder Betreiber der Seiten verantwortlich.</p>
            
            <h3>Urheberrecht</h3>
            <p>Die durch die Seitenbetreiber erstellten Inhalte und Werke auf diesen Seiten unterliegen dem deutschen Urheberrecht. Die Vervielfältigung, Bearbeitung, Verbreitung und jede Art der Verwertung außerhalb der Grenzen des Urheberrechtes bedürfen der schriftlichen Zustimmung des jeweiligen Autors bzw. Erstellers.</p>
        </section>

        <!-- Datenschutz Section (hidden by default) -->
        <section class="legal-page" id="datenschutz" style="display: none;">
            <h1>Datenschutzerklärung</h1>
            
            <h2>1. Datenschutz auf einen Blick</h2>
            <h3>Allgemeine Hinweise</h3>
            <p>Die folgenden Hinweise geben einen einfachen Überblick darüber, was mit Ihren personenbezogenen Daten passiert, wenn Sie unsere Website besuchen.</p>
            
            <h3>Datenerfassung auf unserer Website</h3>
            <p>Die Datenverarbeitung auf dieser Website erfolgt durch den Websitebetreiber. Dessen Kontaktdaten können Sie dem Impressum dieser Website entnehmen.</p>
            
            <h2>2. Allgemeine Hinweise und Pflichtinformationen</h2>
            <h3>Datenschutz</h3>
            <p>Die Betreiber dieser Seiten nehmen den Schutz Ihrer persönlichen Daten sehr ernst. Wir behandeln Ihre personenbezogenen Daten vertraulich und entsprechend der gesetzlichen Datenschutzvorschriften.</p>
            
            <h2>3. Datenerfassung auf unserer Website</h2>
            <h3>Cookies</h3>
            <p>Die Internetseiten verwenden teilweise so genannte Cookies. Cookies richten auf Ihrem Rechner keinen Schaden an und enthalten keine Viren.</p>
            
            <h3>Server-Log-Dateien</h3>
            <p>Der Provider der Seiten erhebt und speichert automatisch Informationen in so genannten Server-Log-Dateien, die Ihr Browser automatisch an uns übermittelt.</p>
        </section>

        <!-- AGB Section (hidden by default) -->
        <section class="legal-page" id="agb" style="display: none;">
            <h1>Allgemeine Geschäftsbedingungen (AGB)</h1>
            
            <h2>1. Geltungsbereich</h2>
            <p>Diese Allgemeinen Geschäftsbedingungen gelten für alle Verträge, die zwischen der Offertly GmbH und dem Kunden geschlossen werden.</p>
            
            <h2>2. Vertragsschluss</h2>
            <p>Der Vertrag kommt zustande durch Annahme des Angebots des Kunden durch Offertly GmbH.</p>
            
            <h2>3. Leistungen</h2>
            <p>Offertly GmbH stellt eine Plattform zur Erstellung von Angeboten zur Verfügung. Die genauen Leistungen ergeben sich aus der Produktbeschreibung.</p>
            
            <h2>4. Preise und Zahlungsbedingungen</h2>
            <p>Die Preise verstehen sich in Euro zuzüglich der gesetzlichen Mehrwertsteuer. Die Zahlung erfolgt im Voraus per Banküberweisung oder Kreditkarte.</p>
        </section>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle" id="toastIcon"></i>
        <span id="toastMessage">Vorgang erfolgreich abgeschlossen</span>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div>
                <div class="footer-logo">
                    <i class="fas fa-file-invoice-dollar"></i>
                    Offertly
                </div>
                <p class="footer-text">
                    Professionelle Angebote in Minuten erstellen mit künstlicher Intelligenz. 
                    Speziell entwickelt für Handwerker, Freelancer und Selbstständige.
                </p>
            </div>
            
            <div>
                <h3 class="footer-heading">Rechtliches</h3>
                <div class="footer-links">
                    <a href="#impressum" class="footer-link">Impressum</a>
                    <a href="javascript:showLegalPage('datenschutz')" class="footer-link">Datenschutzerklärung</a>
                    <a href="javascript:showLegalPage('agb')" class="footer-link">AGB</a>
                </div>
            </div>
            
            <div>
                <h3 class="footer-heading">Kontakt</h3>
                <div class="footer-links">
                    <a href="mailto:info@example.com" class="footer-link">info@example.com</a>
                    <a href="tel:+49123456789" class="footer-link">+49 123 456789</a>
                    <div style="margin-top: 15px;">
                        <a href="#" style="color: #a0aec0; margin-right: 15px; font-size: 18px;"><i class="fab fa-facebook"></i></a>
                        <a href="#" style="color: #a0aec0; margin-right: 15px; font-size: 18px;"><i class="fab fa-twitter"></i></a>
                        <a href="#" style="color: #a0aec0; font-size: 18px;"><i class="fab fa-linkedin"></i></a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="copyright">
            &copy; 2023 Offertly GmbH. Alle Rechte vorbehalten.
        </div>
    </footer>

    <script>
        // Globale Variablen
        let currentOfferData = null;
        let savedDrafts = [];
        const { jsPDF } = window.jspdf;
        
        // DOM-Elemente
        const offerForm = document.getElementById('offerForm');
        const generateBtn = document.getElementById('generateBtn');
        const resetBtn = document.getElementById('resetBtn');
        const demoBtn = document.getElementById('demoBtn');
        const heroGenerateBtn = document.getElementById('heroGenerateBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const previewContainer = document.getElementById('previewContainer');
        const previewContent = document.getElementById('previewContent');
        const loading = document.getElementById('loading');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');
        const toastIcon = document.getElementById('toastIcon');
        const businessTypeSelect = document.getElementById('businessType');
        const customBranchContainer = document.getElementById('customBranchContainer');
        const customBranchInput = document.getElementById('customBranch');
        const saveDraftBtn = document.getElementById('saveDraftBtn');
        const loadDraftBtn = document.getElementById('loadDraftBtn');
        const themeToggle = document.getElementById('themeToggle');
        const mobileThemeToggle = document.getElementById('mobileThemeToggle');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileCloseBtn = document.getElementById('mobileCloseBtn');
        const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');
        const mobileNav = document.getElementById('mobileNav');
        const learnMoreBtn = document.getElementById('learnMoreBtn');
        
        // Initialisierung
        function init() {
            // Aktuelles Datum setzen
            document.getElementById('offerDate').valueAsDate = new Date();
            
            // Event-Listener
            offerForm.addEventListener('submit', generateOffer);
            resetBtn.addEventListener('click', resetForm);
            demoBtn.addEventListener('click', loadDemoData);
            heroGenerateBtn.addEventListener('click', scrollToForm);
            learnMoreBtn.addEventListener('click', scrollToFeatures);
            downloadBtn.addEventListener('click', generatePDF);
            saveDraftBtn.addEventListener('click', saveDraft);
            loadDraftBtn.addEventListener('click', loadDraft);
            
            // Branchen-Änderung Event-Listener
            businessTypeSelect.addEventListener('change', toggleCustomBranch);
            
            // Theme Toggle
            themeToggle.addEventListener('click', toggleTheme);
            mobileThemeToggle.addEventListener('click', toggleTheme);
            
            // Mobile Navigation
            mobileMenuBtn.addEventListener('click', openMobileMenu);
            mobileCloseBtn.addEventListener('click', closeMobileMenu);
            mobileMenuOverlay.addEventListener('click', closeMobileMenu);
            
            // Lade gespeicherte Entwürfe
            loadSavedDrafts();
            
            // Initialisiere Formularvalidierung
            initFormValidation();
            
            // Setze Dark Mode wenn bevorzugt
            if (localStorage.getItem('darkMode') === 'enabled' || 
                (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.body.classList.add('dark-mode');
                updateThemeIcons(true);
            }
        }
        
        // Scroll zu Formular
        function scrollToForm() {
            document.querySelector('.app-container').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Scroll zu Features
        function scrollToFeatures() {
            document.getElementById('features').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Mobile Menu öffnen
        function openMobileMenu() {
            mobileNav.classList.add('show');
            mobileMenuOverlay.classList.add('show');
            document.body.style.overflow = 'hidden';
        }
        
        // Mobile Menu schließen
        function closeMobileMenu() {
            mobileNav.classList.remove('show');
            mobileMenuOverlay.classList.remove('show');
            document.body.style.overflow = '';
        }
        
        // Theme umschalten
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const isDarkMode = document.body.classList.contains('dark-mode');
            
            if (isDarkMode) {
                localStorage.setItem('darkMode', 'enabled');
            } else {
                localStorage.setItem('darkMode', 'disabled');
            }
            
            updateThemeIcons(isDarkMode);
        }
        
        // Theme Icons aktualisieren
        function updateThemeIcons(isDarkMode) {
            const icon = isDarkMode ? 'fa-sun' : 'fa-moon';
            themeToggle.innerHTML = `<i class="fas ${icon}"></i>`;
            mobileThemeToggle.innerHTML = `<i class="fas ${icon}"></i> ${isDarkMode ? 'Light' : 'Dark'} Mode`;
        }
        
        // Rechtsseiten anzeigen
        function showLegalPage(pageId) {
            // Alle Legal Pages verstecken
            document.querySelectorAll('.legal-page').forEach(page => {
                page.style.display = 'none';
            });
            
            // Gewünschte Seite anzeigen
            document.getElementById(pageId).style.display = 'block';
            
            // Zur Seite scrollen
            document.getElementById(pageId).scrollIntoView({ behavior: 'smooth' });
            
            // Mobile Menu schließen falls offen
            closeMobileMenu();
        }
        
        // Formularvalidierung initialisieren
        function initFormValidation() {
            const requiredFields = [
                { id: 'businessName', errorId: 'businessNameError' },
                { id: 'customerName', errorId: 'customerNameError' },
                { id: 'serviceDescription', errorId: 'serviceDescriptionError' },
                { id: 'totalPrice', errorId: 'totalPriceError' },
                { id: 'vatRate', errorId: 'vatRateError' }
            ];
            
            requiredFields.forEach(field => {
                const input = document.getElementById(field.id);
                const error = document.getElementById(field.errorId);
                
                input.addEventListener('input', () => {
                    validateField(input, error);
                });
            });
        }
        
        // Feld validieren
        function validateField(input, errorElement) {
            if (input.required && !input.value.trim()) {
                input.parentElement.classList.add('has-error');
                return false;
            }
            
            if (input.type === 'number') {
                const value = parseFloat(input.value);
                const min = parseFloat(input.min) || -Infinity;
                const max = parseFloat(input.max) || Infinity;
                
                if (isNaN(value) || value < min || value > max) {
                    input.parentElement.classList.add('has-error');
                    return false;
                }
            }
            
            input.parentElement.classList.remove('has-error');
            return true;
        }
        
        // Formular validieren
        function validateForm() {
            let isValid = true;
            
            // Erforderliche Felder validieren
            const requiredFields = [
                { id: 'businessName', errorId: 'businessNameError', message: 'Bitte geben Sie einen Firmennamen ein' },
                { id: 'customerName', errorId: 'customerNameError', message: 'Bitte geben Sie einen Kundennamen ein' },
                { id: 'serviceDescription', errorId: 'serviceDescriptionError', message: 'Bitte beschreiben Sie die Leistung' },
                { id: 'totalPrice', errorId: 'totalPriceError', message: 'Bitte geben Sie einen gültigen Preis ein' }
            ];
            
            requiredFields.forEach(field => {
                const input = document.getElementById(field.id);
                const error = document.getElementById(field.errorId);
                
                if (!validateField(input, error)) {
                    error.textContent = field.message;
                    isValid = false;
                }
            });
            
            // MwSt validieren
            const vatInput = document.getElementById('vatRate');
            const vatError = document.getElementById('vatRateError');
            const vatValue = parseFloat(vatInput.value);
            
            if (isNaN(vatValue) || vatValue < 0 || vatValue > 100) {
                vatInput.parentElement.classList.add('has-error');
                vatError.textContent = 'Bitte geben Sie einen gültigen MwSt-Satz ein (0-100%)';
                isValid = false;
            } else {
                vatInput.parentElement.classList.remove('has-error');
            }
            
            // Benutzerdefinierte Branche validieren
            if (businessTypeSelect.value === 'sonstiges' && !customBranchInput.value.trim()) {
                customBranchContainer.classList.add('has-error');
                document.getElementById('customBranchError').textContent = 'Bitte geben Sie Ihre Branche an';
                isValid = false;
            } else {
                customBranchContainer.classList.remove('has-error');
            }
            
            return isValid;
        }
        
        // Branchen-Eingabe anzeigen/verstecken
        function toggleCustomBranch() {
            if (businessTypeSelect.value === 'sonstiges') {
                customBranchContainer.classList.add('show');
                customBranchInput.required = true;
            } else {
                customBranchContainer.classList.remove('show');
                customBranchInput.required = false;
            }
        }
        
        // Toast anzeigen
        function showToast(message, type = 'success') {
            toastMessage.textContent = message;
            
            // Icon und Farbe basierend auf Typ setzen
            if (type === 'error') {
                toast.className = 'toast error show';
                toastIcon.className = 'fas fa-exclamation-circle';
            } else if (type === 'success') {
                toast.className = 'toast success show';
                toastIcon.className = 'fas fa-check-circle';
            } else {
                toast.className = 'toast show';
                toastIcon.className = 'fas fa-info-circle';
            }
            
            // Nach 3 Sekunden ausblenden
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Formular zurücksetzen
        function resetForm() {
            offerForm.reset();
            document.getElementById('offerDate').valueAsDate = new Date();
            document.getElementById('vatRate').value = "19";
            previewContent.innerHTML = `
                <div class="empty-preview">
                    <i class="fas fa-file-alt empty-icon"></i>
                    <h3 class="empty-title">Ihr Angebot erscheint hier</h3>
                    <p class="empty-text">Füllen Sie das Formular aus und klicken Sie auf "Angebot erstellen", um eine professionelle Angebotsvorlage zu generieren.</p>
                    <button class="btn btn-secondary" id="demoBtn">
                        <i class="fas fa-magic"></i> Demo anzeigen
                    </button>
                    <button class="btn btn-secondary" id="loadDraftBtn" style="margin-top: 15px;">
                        <i class="fas fa-folder-open"></i> Entwurf laden
                    </button>
                </div>
            `;
            // Event-Listener für Demo-Button neu setzen
            document.getElementById('demoBtn').addEventListener('click', loadDemoData);
            document.getElementById('loadDraftBtn').addEventListener('click', loadDraft);
            toggleCustomBranch(); // Zurücksetzen der Branchen-Anzeige
            showToast('Formular zurückgesetzt');
        }
        
        // Angebotsnummer generieren
        function generateOfferNumber() {
            const year = new Date().getFullYear();
            const month = String(new Date().getMonth() + 1).padStart(2, '0');
            const day = String(new Date().getDate()).padStart(2, '0');
            const random = Math.floor(Math.random() * 999) + 1;
            return `${year}${month}${day}-${random.toString().padStart(3, '0')}`;
        }
        
        // KI-Textgenerierung
        function generateOfferText(data) {
            const branchTemplates = {
                maler: {
                    greeting: `Sehr geehrte ${data.customerName.split(' ')[0] === 'Familie' ? 'Familie' : 'Herr/Frau'} ${data.customerName.split(' ').pop()},`,
                    intro: 'vielen Dank für Ihre Anfrage bezüglich der Malerarbeiten. Wir freuen uns, Ihnen folgendes Angebot unterbreiten zu dürfen:',
                    services: [
                        'Fachgerechte Vorbereitung der Untergründe',
                        'Verwendung hochwertiger, schadstoffarmer Farben und Materialien',
                        'Sorgfältiges Abkleben und Abdecken aller Flächen',
                        'Grundierung der Oberflächen für optimale Haftung',
                        'Zwei Deckanstriche mit Premium-Dispersionsfarbe',
                        'Saubere Ausführung und Entsorgung von Materialresten'
                    ],
                    closing: 'Wir stehen für Rückfragen gerne zur Verfügung und freuen uns auf eine mögliche Zusammenarbeit.'
                },
                elektriker: {
                    greeting: `Sehr geehrte/r ${data.customerName.split(' ')[0]},`,
                    intro: 'herzlichen Dank für Ihre Anfrage. Gerne unterbreiten wir Ihnen unser Angebot für die Elektroarbeiten:',
                    services: [
                        'Fachgerechte Installation nach aktuellen VDE-Vorschriften',
                        'Verwendung von geprüften Materialien und Komponenten',
                        'Dokumentation aller durchgeführten Arbeiten',
                        'Abschlussmessung und Abnahme der Anlagen',
                        'Einweisung in die Funktion der installierten Systeme'
                    ],
                    closing: 'Für weitere Informationen stehen wir Ihnen gerne zur Verfügung.'
                },
                it: {
                    greeting: `Sehr geehrte/r ${data.customerName.split(' ')[0]},`,
                    intro: 'vielen Dank für Ihr Interesse an unseren IT-Dienstleistungen. Wir freuen uns, Ihnen folgendes Angebot vorlegen zu können:',
                    services: [
                        'Individuelle Konzeption und Planung',
                        'Moderne und responsive Umsetzung',
                        'Testing und Qualitätssicherung',
                        'Dokumentation aller Entwicklungen',
                        'Einweisung und Schulung',
                        'Technischer Support nach Vereinbarung'
                    ],
                    closing: 'Wir freuen uns auf Ihre Rückmeldung und eine mögliche Zusammenarbeit.'
                },
                beratung: {
                    greeting: `Sehr geehrte/r ${data.customerName.split(' ')[0]},`,
                    intro: 'vielen Dank für Ihr Interesse an unseren Beratungsdienstleistungen. Gerne unterbreiten wir Ihnen folgendes Angebot:',
                    services: [
                        'Individuelle Bedarfsanalyse',
                        'Maßgeschneiderte Konzepte und Lösungen',
                        'Praktische Umsetzungsbegleitung',
                        'Dokumentation und Ergebnispräsentation',
                        'Nachbetreuung und Follow-up'
                    ],
                    closing: 'Wir stehen für weitere Fragen gerne zur Verfügung.'
                },
                default: {
                    greeting: `Sehr geehrte/r ${data.customerName.split(' ')[0]},`,
                    intro: 'vielen Dank für Ihre Anfrage. Gerne unterbreiten wir Ihnen folgendes Angebot:',
                    services: [
                        'Fachgerechte Durchführung der vereinbarten Leistungen',
                        'Verwendung hochwertiger Materialien und Werkzeuge',
                        'Termingerechte Ausführung',
                        'Sorgfältige Arbeitsweise',
                        'Gewährleistung gemäß gesetzlicher Bestimmungen'
                    ],
                    closing: 'Für Rückfragen stehen wir Ihnen gerne zur Verfügung.'
                }
            };
            
            // Wenn "Sonstiges" ausgewählt ist, verwende den benutzerdefinierten Branchennamen
            let branch = data.businessType;
            if (branch === 'sonstiges' && data.customBranch) {
                branch = data.customBranch.toLowerCase();
            }
            
            const template = branchTemplates[branch] || branchTemplates.default;
            
            return {
                greeting: template.greeting,
                intro: template.intro,
                services: [...template.services, ...data.serviceDescription.split('. ').filter(item => item.trim())],
                closing: template.closing
            };
        }
        
        // Zahlungsbedingungen-Text
        function getPaymentTermsText(paymentTerms) {
            const terms = {
                'sofort': 'Zahlung bei Auftragserteilung',
                'abnahme': 'Zahlung bei Abnahme der Leistung',
                '14tage': 'Zahlung innerhalb von 14 Tagen nach Rechnungsstellung',
                '30tage': 'Zahlung innerhalb von 30 Tagen nach Rechnungsstellung',
                'anzahlung': '50% Anzahlung bei Auftragserteilung, Restzahlung bei Fertigstellung'
            };
            return terms[paymentTerms] || terms['abnahme'];
        }
        
        // Demo-Daten laden
        function loadDemoData() {
            const demoData = {
                businessName: 'Malerbetrieb Schmidt GmbH',
                businessAddress: 'Handwerkerstraße 45\n12345 Musterstadt\nTel: 0123/456789\ninfo@maler-schmidt.de',
                businessType: 'maler',
                customerName: 'Familie Müller',
                customerAddress: 'Eichenstraße 123\n54321 Beispielstadt',
                serviceDescription: 'Streichen von ca. 45 m² Wandfläche im Wohnzimmer und Flur mit hochwertiger Dispersionsfarbe, inklusive Abkleben, Abdecken, Grundierung und zwei Anstriche. Verwendung von schadstoffarmer Innenfarbe.',
                totalPrice: '650.00',
                vatRate: '19',
                deliveryTime: 'KW 35/2025 (nach Absprache)',
                paymentTerms: 'abnahme'
            };

            // Formular mit Demo-Daten füllen
            Object.keys(demoData).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = demoData[key];
                }
            });

            // Branchen-Anzeige aktualisieren
            toggleCustomBranch();
            
            // Angebot generieren
            generateOffer({ preventDefault: () => {} });
            
            showToast('Demo-Daten geladen');
        }
        
        // Gespeicherte Entwürfe laden
        function loadSavedDrafts() {
            const drafts = localStorage.getItem('offertlyDrafts');
            if (drafts) {
                savedDrafts = JSON.parse(drafts);
            }
        }
        
        // Entwurf speichern
        function saveDraft() {
            if (!validateForm()) {
                showToast('Bitte korrigieren Sie die Fehler im Formular', 'error');
                return;
            }
            
            const formData = new FormData(offerForm);
            const data = Object.fromEntries(formData.entries());
            
            // Entwurfsdatum hinzufügen
            data.draftDate = new Date().toISOString();
            
            // Entwurf speichern
            savedDrafts.push(data);
            localStorage.setItem('offertlyDrafts', JSON.stringify(savedDrafts));
            
            showToast('Entwurf erfolgreich gespeichert');
        }
        
        // Entwurf laden
        function loadDraft() {
            if (savedDrafts.length === 0) {
                showToast('Keine gespeicherten Entwürfe gefunden', 'error');
                return;
            }
            
            // Neuesten Entwurf laden
            const latestDraft = savedDrafts[savedDrafts.length - 1];
            
            // Formular mit Entwurfsdaten füllen
            Object.keys(latestDraft).forEach(key => {
                const element = document.getElementById(key);
                if (element && key !== 'draftDate') {
                    element.value = latestDraft[key];
                }
            });
            
            // Branchen-Anzeige aktualisieren
            toggleCustomBranch();
            
            showToast('Entwurf erfolgreich geladen');
        }
        
        // Angebot generieren
        function generateOffer(e) {
            e.preventDefault();
            
            if (!validateForm()) {
                showToast('Bitte korrigieren Sie die Fehler im Formular', 'error');
                return;
            }
            
            const formData = new FormData(offerForm);
            const data = Object.fromEntries(formData.entries());
            
            // Wenn "Sonstiges" ausgewählt ist, benutzerdefinierte Branche hinzufügen
            if (data.businessType === 'sonstiges') {
                data.businessType = data.customBranch || 'sonstiges';
            }
            
            // Loading anzeigen
            loading.classList.add('show');
            generateBtn.disabled = true;
            generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Wird erstellt...';
            
            // Simulation der KI-Verarbeitung
            setTimeout(() => {
                const offerNumber = generateOfferNumber();
                const aiText = generateOfferText(data);
                
                // Preisberechnung
                const netPrice = parseFloat(data.totalPrice);
                const vatRate = parseFloat(data.vatRate);
                const vatAmount = netPrice * (vatRate / 100);
                const grossPrice = netPrice + vatAmount;
                
                // Angebots-HTML erstellen
                const offerHTML = `
                    <div class="offer-header">
                        <div class="company-info">
                            <div class="company-name">${data.businessName}</div>
                            <div class="company-address">${data.businessAddress.replace(/\n/g, '<br>')}</div>
                        </div>
                        <div class="offer-meta">
                            <div class="offer-number">Angebot Nr.: ${offerNumber}</div>
                            <div class="offer-date">Datum: ${new Date(data.offerDate).toLocaleDateString('de-DE')}</div>
                        </div>
                    </div>
                    
                    <div class="customer-info">
                        <div class="customer-title">Kunde:</div>
                        ${data.customerName}<br>
                        ${data.customerAddress.replace(/\n/g, '<br>')}
                    </div>
                    
                    <div class="offer-content">
                        <div class="offer-greeting">
                            <p>${aiText.greeting}</p>
                            <br>
                            <p>${aiText.intro}</p>
                        </div>
                        
                        <div class="service-description">
                            <strong>Leistungsbeschreibung:</strong><br><br>
                            ${data.serviceDescription.replace(/\n/g, '<br>')}
                            
                            <div style="margin-top: 15px;">
                                <strong>Inkludierte Leistungen:</strong>
                                <ul style="margin-top: 8px; padding-left: 20px;">
                                    ${aiText.services.map(service => `<li>${service}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                        
                        <div class="price-section">
                            <div class="price-row">
                                <span>Nettopreis:</span>
                                <span>${netPrice.toFixed(2)} €</span>
                            </div>
                            
                            ${vatRate > 0 ? `
                                <div class="price-row">
                                    <span>zzgl. ${vatRate}% MwSt.:</span>
                                    <span>${vatAmount.toFixed(2)} €</span>
                                </div>
                                <div class="price-row price-total">
                                    <span>Gesamtpreis:</span>
                                    <span>${grossPrice.toFixed(2)} €</span>
                                </div>
                            ` : `
                                <div class="price-row price-total">
                                    <span>Gesamtpreis:</span>
                                    <span>${netPrice.toFixed(2)} € (inkl. USt. gem. §19 UStG)</span>
                                </div>
                            `}
                        </div>
                        
                        <div style="margin-top: 25px;">
                            <strong>Zahlungsbedingungen:</strong><br>
                            ${getPaymentTermsText(data.paymentTerms)}
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <strong>Ausführungszeitraum:</strong><br>
                            ${data.deliveryTime || 'Nach Vereinbarung'}
                        </div>
                        
                        <br>
                        <p>${aiText.closing}</p>
                        <br>
                        <p>Mit freundlichen Grüßen</p>
                        <p style="margin-top: 10px;"><strong>${data.businessName}</strong></p>
                    </div>
                    
                    <div class="terms-section">
                        <strong>Hinweise:</strong><br>
                        • Dieses Angebot ist 30 Tage ab Ausstellungsdatum gültig<br>
                        • Alle Preise verstehen sich zuzüglich der gesetzlichen Mehrwertsteuer, sofern nicht anders angegeben<br>
                        • Änderungen und Zusatzleistungen werden gesondert berechnet<br>
                        • Es gelten unsere Allgemeinen Geschäftsbedingungen
                    </div>
                `;
                
                previewContent.innerHTML = offerHTML;
                
                // Daten für PDF speichern
                currentOfferData = {
                    html: offerHTML,
                    data: data,
                    offerNumber: offerNumber,
                    netPrice: netPrice,
                    vatAmount: vatAmount,
                    grossPrice: grossPrice
                };
                
                // Loading ausblenden
                loading.classList.remove('show');
                generateBtn.disabled = false;
                generateBtn.innerHTML = '<i class="fas fa-robot"></i> Angebot erstellen';
                
                showToast('Angebot erfolgreich generiert!');
            }, 1500);
        }
        
        // PDF generieren
        function generatePDF() {
            if (!currentOfferData) {
                showToast('Bitte erstellen Sie zuerst ein Angebot', 'error');
                return;
            }
            
            downloadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Wird erstellt...';
            downloadBtn.disabled = true;
            
            // Erstelle ein temporäres Element für html2canvas
            const tempDiv = document.createElement('div');
            tempDiv.style.width = '794px'; // A4 width in pixels (210mm)
            tempDiv.style.padding = '40px';
            tempDiv.style.background = 'white';
            tempDiv.style.fontFamily = 'Georgia, serif';
            tempDiv.innerHTML = currentOfferData.html;
            
            // Füge es dem Dokument hinzu (unsichtbar)
            tempDiv.style.position = 'absolute';
            tempDiv.style.left = '-9999px';
            document.body.appendChild(tempDiv);
            
            // Erstelle das PDF nach einer kurzen Verzögerung
            setTimeout(() => {
                html2canvas(tempDiv, {
                    scale: 2,
                    useCORS: true,
                    logging: false
                }).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    const pdf = new jsPDF({
                        orientation: 'portrait',
                        unit: 'mm',
                        format: 'a4'
                    });
                    
                    const imgWidth = 210; // A4 width in mm
                    const imgHeight = canvas.height * imgWidth / canvas.width;
                    
                    pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
                    
                    // Dateinamen generieren
                    const fileName = `Angebot_${currentOfferData.offerNumber}_${currentOfferData.data.customerName.replace(/\s+/g, '_')}.pdf`;
                    
                    // PDF speichern
                    pdf.save(fileName);
                    
                    // Temporäres Element entfernen
                    document.body.removeChild(tempDiv);
                    
                    downloadBtn.innerHTML = '<i class="fas fa-download"></i> PDF';
                    downloadBtn.disabled = false;
                    
                    showToast('PDF erfolgreich heruntergeladen!');
                }).catch(error => {
                    console.error('PDF Generation Error:', error);
                    showToast('Fehler beim Erstellen des PDFs', 'error');
                    downloadBtn.innerHTML = '<i class="fas fa-download"></i> PDF';
                    downloadBtn.disabled = false;
                });
            }, 500);
        }
        
        // Initialisierung beim Laden
        document.addEventListener('DOMContentLoaded', init);
        
        // Google Analytics (falls gewünscht)
        // Hier würde normalerweise der Tracking-Code stehen
        // window.dataLayer = window.dataLayer || [];
        // function gtag(){dataLayer.push(arguments);}
        // gtag('js', new Date());
        // gtag('config', 'GA_MEASUREMENT_ID');
    </script>
</body>
    </html>
